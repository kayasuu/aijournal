{% extends "base.html" %}

{% block body %}
<div class="container">
    <h1>Edit Journal Entry</h1>
    <form action="/api/entries/edit/{{ entry[0] }}" method="POST" class="entry-form">
        <label for="title">Title:</label>
        <input type="text" name="title" value="{{ entry[2] }}" required><br><br>
        <label for="content">Content:</label><br>
        <textarea name="content" rows="10" cols="30" required>{{ entry[3] }}</textarea><br><br>
        <input type="submit" value="Update">
    </form>
    <form action="/api/entries/delete/{{ entry[0] }}" method="POST" onsubmit="return confirm('Are you sure you want to delete this entry?');">
        <input type="submit" value="Delete">
    </form>
    <form action="{{ url_for('analyze_sentiment', entry_id=entry[0]) }}" method="post" id="sentiment-analysis-form">
        <input type="submit" value="Sentiment Analysis">
    </form>
    <a href="/entries">Back to entries</a>
</div>
<div id="sentiment-result"></div>

{% block javascript %}
<script>
    document.getElementById("sentiment-analysis-form").addEventListener("submit", function(event) {
        event.preventDefault();

        fetch(event.target.action, {
            method: "POST"
        })
        .then(response => response.json())
        .then(data => {
            document.getElementById("sentiment-result").innerText = "Sentiment: " + data.sentiment;
        });
    });
</script>
{% endblock %}
{% endblock %}